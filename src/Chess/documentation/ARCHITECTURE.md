# ğŸ—ï¸ Arquitectura del Chess Module

## ğŸ“Š Diagrama de Componentes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND (Browser)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  main.js     â”‚  â”‚  MetaMask    â”‚  â”‚ Socket.io    â”‚             â”‚
â”‚  â”‚  (UI Logic)  â”‚  â”‚  (Wallet)    â”‚  â”‚  Client      â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                  â”‚                  â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                            â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   HTTP / WS       â”‚
                    â”‚   (Port 3000)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND (NestJS)                                â”‚
â”‚                            â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚           ChessGateway (WebSocket)               â”‚               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ register                                â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ startGame                               â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ joinGame                                â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ makeMove        â—„â”€â”€â”€â”€â”€REAL TIME         â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ claimVictory                            â”‚  â”‚               â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚         ChessService (Business Logic)        â”‚                  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                  â”‚
â”‚  â”‚  â”‚  â€¢ Game state validation               â”‚ â”‚                  â”‚
â”‚  â”‚  â”‚  â€¢ Move execution (chess.js)           â”‚ â”‚                  â”‚
â”‚  â”‚  â”‚  â€¢ Channel management                   â”‚ â”‚                  â”‚
â”‚  â”‚  â”‚  â€¢ Player registry                      â”‚ â”‚                  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                  â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚      â”‚                             â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Signature    â”‚         â”‚ Blockchain        â”‚                    â”‚
â”‚  â”‚ Service      â”‚         â”‚ Listener Service  â”‚                    â”‚
â”‚  â”‚ (ECDSA)      â”‚         â”‚ (Events)          â”‚                    â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚      â”‚                              â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STORAGE LAYER                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚  In-Memory Maps  â”‚    â”‚  Redis (Future)  â”‚                      â”‚
â”‚  â”‚  â€¢ activeGames   â”‚    â”‚  â€¢ Scalability   â”‚                      â”‚
â”‚  â”‚  â€¢ gameChannels  â”‚    â”‚  â€¢ Persistence   â”‚                      â”‚
â”‚  â”‚  â€¢ playerGames   â”‚    â”‚  â€¢ Pub/Sub       â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BLOCKCHAIN LAYER (Sepolia)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              SessionSafe Smart Contract                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Events:                                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ WagerDeposited(gameId, player, amount)           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ GameSettled(gameId, winner, payout)              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Functions:                                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ deposit(gameId, amount)                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ settle(gameId, signatures)                       â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flujo de Datos

### 1ï¸âƒ£ Inicio de Partida

```
User (Browser)
    â”‚
    â”œâ”€ 1. Sign Message: "Start Chess Game - Wager: 10 USDC"
    â”‚
    â”œâ”€ 2. Emit â†’ startGame({ address, wager, signature })
    â”‚
    â–¼
ChessGateway
    â”‚
    â”œâ”€ 3. Verify Signature (SignatureService)
    â”‚
    â”œâ”€ 4. Create Game (ChessService)
    â”‚        â€¢ Generate gameId
    â”‚        â€¢ Initialize chess.js board
    â”‚        â€¢ Store in memory
    â”‚
    â”œâ”€ 5. Emit â†’ gameStarted({ gameId, ... })
    â”‚
    â–¼
User 1 & User 2
```

### 2ï¸âƒ£ ConfirmaciÃ³n de DepÃ³sito

```
User (MetaMask)
    â”‚
    â”œâ”€ 1. Send Transaction â†’ SessionSafe.deposit(gameId, 10 USDC)
    â”‚
    â–¼
Blockchain (Sepolia)
    â”‚
    â”œâ”€ 2. Mine Transaction
    â”‚
    â”œâ”€ 3. Emit Event â†’ WagerDeposited(gameId, player, 10e6)
    â”‚
    â–¼
BlockchainListenerService
    â”‚
    â”œâ”€ 4. Detect Event
    â”‚
    â”œâ”€ 5. Confirm Channel (ChessService)
    â”‚
    â”œâ”€ 6. Notify Players (ChessGateway)
    â”‚        â€¢ Emit â†’ wagerConfirmed({ txHash, amount })
    â”‚
    â–¼
Users (Both)
```

### 3ï¸âƒ£ Movimiento en Partida

```
User A
    â”‚
    â”œâ”€ 1. Select Move: "e2e4"
    â”‚
    â”œâ”€ 2. Sign: "Move: e2e4 | Game: game_123 | Nonce: 1"
    â”‚
    â”œâ”€ 3. Emit â†’ makeMove({ gameId, move, nonce, signature })
    â”‚
    â–¼
ChessGateway (< 10ms)
    â”‚
    â”œâ”€ 4. Verify Signature âœ“
    â”‚
    â”œâ”€ 5. Validate Nonce âœ“
    â”‚
    â”œâ”€ 6. Check Turn âœ“
    â”‚
    â–¼
ChessService
    â”‚
    â”œâ”€ 7. Load Board State (FEN)
    â”‚
    â”œâ”€ 8. Validate Move (chess.js) âœ“
    â”‚       â€¢ Check if legal
    â”‚       â€¢ Apply move
    â”‚       â€¢ Check checkmate/stalemate
    â”‚
    â”œâ”€ 9. Update State
    â”‚       â€¢ Store move in history
    â”‚       â€¢ Update FEN
    â”‚       â€¢ Increment nonce
    â”‚
    â–¼
ChessGateway
    â”‚
    â”œâ”€ 10. Broadcast â†’ moveMade({ newBoardState, isCheckmate, ... })
    â”‚
    â–¼
User A & User B (both receive instantly)
```

### 4ï¸âƒ£ Checkmate y Settlement

```
Winner
    â”‚
    â”œâ”€ 1. Click "Claim Victory"
    â”‚
    â”œâ”€ 2. Sign Final State
    â”‚
    â”œâ”€ 3. Emit â†’ claimVictory({ gameId, signature })
    â”‚
    â–¼
ChessService
    â”‚
    â”œâ”€ 4. Verify Checkmate State âœ“
    â”‚
    â”œâ”€ 5. Generate Settlement Proof
    â”‚       â€¢ Final board state
    â”‚       â€¢ Move history
    â”‚       â€¢ Both signatures
    â”‚
    â–¼
Backend â†’ Blockchain
    â”‚
    â”œâ”€ 6. Call SessionSafe.settle(gameId, proof)
    â”‚
    â–¼
Blockchain
    â”‚
    â”œâ”€ 7. Verify Signatures âœ“
    â”‚
    â”œâ”€ 8. Transfer Funds
    â”‚       â€¢ Winner receives pot (20 USDC)
    â”‚       â€¢ Service fee (if any)
    â”‚
    â”œâ”€ 9. Emit â†’ GameSettled(gameId, winner, 20e6)
    â”‚
    â–¼
BlockchainListenerService
    â”‚
    â”œâ”€ 10. Emit â†’ settlementCompleted({ winner, payout })
    â”‚
    â–¼
Winner (Receives funds in wallet)
```

---

## ğŸ“¦ Estructura de MÃ³dulos

```
ChessModule
â”‚
â”œâ”€â”€ Providers
â”‚   â”œâ”€â”€ ChessGateway          â—„â”€ WebSocket communication
â”‚   â”œâ”€â”€ ChessService          â—„â”€ Game logic
â”‚   â”œâ”€â”€ SignatureService      â—„â”€ ECDSA verification
â”‚   â””â”€â”€ BlockchainListener    â—„â”€ Event detection
â”‚
â”œâ”€â”€ Controllers
â”‚   â””â”€â”€ ChessController       â—„â”€ REST endpoints
â”‚
â”œâ”€â”€ DTOs
â”‚   â””â”€â”€ chess.dto.ts          â—„â”€ Validation schemas
â”‚
â”œâ”€â”€ Interfaces
â”‚   â””â”€â”€ chess.interface.ts    â—„â”€ TypeScript types
â”‚
â””â”€â”€ Config
    â””â”€â”€ chess.config.ts       â—„â”€ Configuration
```

---

## ğŸ” Seguridad en Capas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: Transport Security                   â”‚
â”‚  â€¢ HTTPS/WSS encryption                        â”‚
â”‚  â€¢ CORS configuration                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: Authentication                       â”‚
â”‚  â€¢ Wallet signature verification (ECDSA)      â”‚
â”‚  â€¢ Address recovery & validation               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: Authorization                        â”‚
â”‚  â€¢ Player identification                       â”‚
â”‚  â€¢ Turn validation                             â”‚
â”‚  â€¢ Game ownership check                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: State Integrity                      â”‚
â”‚  â€¢ Nonce validation (replay protection)       â”‚
â”‚  â€¢ State channel balance tracking              â”‚
â”‚  â€¢ Move history immutability                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 5: Game Rules                           â”‚
â”‚  â€¢ chess.js validation engine                  â”‚
â”‚  â€¢ Legal move verification                     â”‚
â”‚  â€¢ Checkmate detection                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 6: Blockchain Finality                  â”‚
â”‚  â€¢ Smart contract verification                 â”‚
â”‚  â€¢ On-chain fund distribution                  â”‚
â”‚  â€¢ Cryptographic proof settlement              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ Ventajas de la Arquitectura

### 1. **Ultra-Baja Latencia**
- WebSocket persistente â†’ Sin overhead de HTTP
- Estado en memoria â†’ Sin latencia de DB
- Resultado: **< 50ms por movimiento**

### 2. **Escalabilidad**
- State Channels â†’ 1000s de movimientos off-chain
- Redis ready â†’ Horizontal scaling
- Microservicio independiente

### 3. **Seguridad**
- Firmas ECDSA en cada acciÃ³n
- VerificaciÃ³n en backend (no confiar en frontend)
- Blockchain como Ã¡rbitro final

### 4. **UX Web2 en Web3**
- Experiencia instantÃ¡nea
- Solo 1 transacciÃ³n (settlement)
- Gas fee: $0 durante el juego

---

## ğŸ”® EvoluciÃ³n Futura

```
v1.0 (Actual)
  â””â”€ Single-server memory

v1.1 (PrÃ³ximo)
  â””â”€ Redis para persistencia
      â””â”€ Pub/Sub para multi-server

v2.0 (Futuro)
  â””â”€ Microservicios separados
      â”œâ”€ Gateway Service (Socket.io)
      â”œâ”€ Game Engine Service (chess.js)
      â”œâ”€ Signature Service (ECDSA)
      â””â”€ Blockchain Service (Events)
          â””â”€ Message Queue (RabbitMQ/Kafka)
```

---

**VersiÃ³n:** 1.0.0  
**Ãšltima actualizaciÃ³n:** 4 de febrero de 2026
